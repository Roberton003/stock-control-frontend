# pytest.ini - Configuração do Pytest para o projeto

[pytest]
# Módulo de configurações do Django
DJANGO_SETTINGS_MODULE = config.settings

# Diretórios de testes
testpaths = 
    tests
    inventory/tests
    e2e_tests

# Padrões de arquivos de teste
python_files = 
    test_*.py
    *_test.py
    tests.py

# Padrões de classes de teste
python_classes = 
    Test*
    *Test

# Padrões de funções de teste
python_functions = 
    test_*
    *_test

# Marcadores personalizados
markers =
    unit: marca testes unitários
    integration: marca testes de integração
    e2e: marca testes end-to-end
    ui: marca testes de interface do usuário
    api: marca testes de API
    slow: marca testes lentos
    fast: marca testes rápidos
    database: marca testes que requerem banco de dados
    browser: marca testes que requerem navegador
    auth: marca testes de autenticação
    stock: marca testes relacionados a estoque
    product: marca testes relacionados a produtos
    lot: marca testes relacionados a lotes
    movement: marca testes relacionados a movimentações
    requisition: marca testes relacionados a requisições

# Opções adicionais
addopts = 
    --tb=short
    --strict-markers
    --strict-config
    -ra
    --maxfail=1
    --cov=inventory
    --cov-report=html:test_results/coverage_html
    --cov-report=xml:test_results/coverage.xml
    --cov-report=term-missing
    --junitxml=test_results/junit/results.xml
    --html=test_results/html/report.html
    --self-contained-html

# Configurações de cobertura
[coverage:run]
source = inventory
omit = 
    */migrations/*
    */tests/*
    */venv/*
    */node_modules/*
    manage.py
    */settings/*
    */wsgi.py
    */asgi.py
    */apps.py

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if settings.DEBUG

[tool:pytest]
# Configurações específicas para diferentes tipos de testes
[tool.pytest.unit]
markers = unit
addopts = --strict-markers

[tool.pytest.integration]
markers = integration
addopts = --strict-markers

[tool.pytest.e2e]
markers = e2e
addopts = --strict-markers

[tool.pytest.ui]
markers = ui
addopts = --strict-markers

[tool.pytest.api]
markers = api
addopts = --strict-markers