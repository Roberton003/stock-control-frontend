<!-- filter_component.html - Componente de filtro moderno -->
<div class="filter-container-modern {% if classes %}{{ classes }}{% endif %}" id="{{ filter_id }}">
    <div class="filter-header-modern">
        <h3 class="text-lg font-medium text-gray-900">
            <i class="fas fa-filter mr-2"></i>
            {{ title|default:"Filtros" }}
        </h3>
        <button type="button" class="filter-toggle-btn" onclick="toggleFilters('{{ filter_id }}')">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
    
    <div class="filter-body-modern" id="{{ filter_id }}-body">
        <form class="filter-form" id="{{ filter_id }}-form">
            <div class="filter-fields-grid">
                {% for field in fields %}
                <div class="filter-field-wrapper">
                    <label for="{{ field.id }}" class="filter-label">
                        {{ field.label }}
                    </label>
                    
                    {% if field.type == 'text' or field.type == 'email' or field.type == 'number' %}
                    <input 
                        type="{{ field.type }}" 
                        id="{{ field.id }}" 
                        name="{{ field.name }}" 
                        class="filter-input"
                        {% if field.placeholder %}placeholder="{{ field.placeholder }}"{% endif %}
                        {% if field.value %}value="{{ field.value }}"{% endif %}
                    >
                    
                    {% elif field.type == 'select' %}
                    <select id="{{ field.id }}" name="{{ field.name }}" class="filter-select">
                        {% if field.placeholder %}
                        <option value="">{{ field.placeholder }}</option>
                        {% endif %}
                        {% for option in field.options %}
                        <option value="{{ option.value }}" {% if option.selected %}selected{% endif %}>{{ option.label }}</option>
                        {% endfor %}
                    </select>
                    
                    {% elif field.type == 'date' %}
                    <input 
                        type="date" 
                        id="{{ field.id }}" 
                        name="{{ field.name }}" 
                        class="filter-input"
                        {% if field.value %}value="{{ field.value }}"{% endif %}
                    >
                    
                    {% elif field.type == 'daterange' %}
                    <div class="date-range-wrapper">
                        <input 
                            type="date" 
                            id="{{ field.id }}-start" 
                            name="{{ field.name }}_start" 
                            class="filter-input date-range-input"
                            {% if field.start_value %}value="{{ field.start_value }}"{% endif %}
                            placeholder="De"
                        >
                        <span class="date-range-separator">até</span>
                        <input 
                            type="date" 
                            id="{{ field.id }}-end" 
                            name="{{ field.name }}_end" 
                            class="filter-input date-range-input"
                            {% if field.end_value %}value="{{ field.end_value }}"{% endif %}
                            placeholder="Até"
                        >
                    </div>
                    
                    {% elif field.type == 'checkbox' %}
                    <div class="filter-checkbox-wrapper">
                        {% for option in field.options %}
                        <div class="filter-checkbox-item">
                            <input 
                                type="checkbox" 
                                id="{{ option.id }}" 
                                name="{{ field.name }}" 
                                value="{{ option.value }}" 
                                class="filter-checkbox"
                                {% if option.checked %}checked{% endif %}
                            >
                            <label for="{{ option.id }}" class="filter-checkbox-label">
                                {{ option.label }}
                            </label>
                        </div>
                        {% endfor %}
                    </div>
                    
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            
            <div class="filter-actions">
                <button type="button" class="btn btn-outline filter-reset-btn" onclick="resetFilters('{{ filter_id }}')">
                    <i class="fas fa-undo mr-2"></i>
                    Limpar
                </button>
                <button type="button" class="btn btn-primary filter-apply-btn" onclick="applyFilters('{{ filter_id }}')">
                    <i class="fas fa-search mr-2"></i>
                    Aplicar Filtros
                </button>
            </div>
        </form>
    </div>
</div>

<style>
.filter-container-modern {
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    overflow: hidden;
    border: 1px solid #e5e7eb;
    margin-bottom: 1.5rem;
}

.filter-header-modern {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid #e5e7eb;
    background-color: #f9fafb;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.filter-body-modern {
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.filter-body-modern.collapsed {
    display: none;
}

.filter-fields-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
}

.filter-field-wrapper {
    margin-bottom: 1rem;
}

.filter-field-wrapper:last-child {
    margin-bottom: 0;
}

.filter-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: #374151;
    font-size: 0.875rem;
}

.filter-input,
.filter-select {
    display: block;
    width: 100%;
    padding: 0.75rem;
    font-size: 0.875rem;
    line-height: 1.5;
    color: #374151;
    background-color: #ffffff;
    background-clip: padding-box;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.filter-input:focus,
.filter-select:focus {
    color: #374151;
    background-color: #ffffff;
    border-color: #034EA2;
    outline: 0;
    box-shadow: 0 0 0 3px rgba(3, 78, 162, 0.25);
}

.date-range-wrapper {
    display: flex;
    align-items: center;
}

.date-range-input {
    flex: 1;
}

.date-range-separator {
    margin: 0 0.5rem;
    color: #6b7280;
    font-size: 0.875rem;
}

.filter-checkbox-wrapper {
    display: flex;
    flex-direction: column;
    space-y: 0.5rem;
}

.filter-checkbox-item {
    display: flex;
    align-items: center;
    margin-bottom: 0.5rem;
}

.filter-checkbox-item:last-child {
    margin-bottom: 0;
}

.filter-checkbox {
    width: 1rem;
    height: 1rem;
    border: 1px solid #d1d5db;
    border-radius: 0.25rem;
    color: #034EA2;
    accent-color: #034EA2;
}

.filter-checkbox-label {
    margin-left: 0.75rem;
    font-weight: 400;
    color: #374151;
    font-size: 0.875rem;
}

.filter-actions {
    display: flex;
    justify-content: flex-end;
    space-x: 0.75rem;
}

.filter-toggle-btn {
    background: none;
    border: none;
    color: #6b7280;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
}

.filter-toggle-btn:hover {
    background-color: #e5e7eb;
    color: #374151;
}

.filter-reset-btn {
    margin-right: 0.75rem;
}

/* Estados responsivos */
@media (max-width: 768px) {
    .filter-fields-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .filter-actions {
        flex-direction: column;
    }
    
    .filter-reset-btn {
        margin-right: 0;
        margin-bottom: 0.75rem;
    }
}
</style>

<script>
function toggleFilters(filterId) {
    const filterBody = document.getElementById(`${filterId}-body`);
    const toggleBtn = document.querySelector(`#${filterId} .filter-toggle-btn i`);
    
    if (filterBody.classList.contains('collapsed')) {
        filterBody.classList.remove('collapsed');
        toggleBtn.classList.remove('fa-chevron-right');
        toggleBtn.classList.add('fa-chevron-down');
    } else {
        filterBody.classList.add('collapsed');
        toggleBtn.classList.remove('fa-chevron-down');
        toggleBtn.classList.add('fa-chevron-right');
    }
}

function applyFilters(filterId) {
    const filterForm = document.getElementById(`${filterId}-form`);
    const formData = new FormData(filterForm);
    
    // Converter FormData para objeto
    const data = {};
    for (const [key, value] of formData.entries()) {
        if (data[key]) {
            // Se já existe, converter para array
            if (Array.isArray(data[key])) {
                data[key].push(value);
            } else {
                data[key] = [data[key], value];
            }
        } else {
            data[key] = value;
        }
    }
    
    // Disparar evento personalizado com os dados do filtro
    const filterEvent = new CustomEvent('filtersApplied', {
        detail: {
            filterId: filterId,
            data: data
        }
    });
    
    document.dispatchEvent(filterEvent);
    
    console.log('Filtros aplicados:', data);
}

function resetFilters(filterId) {
    const filterForm = document.getElementById(`${filterId}-form`);
    filterForm.reset();
    
    // Disparar evento personalizado para reset
    const resetEvent = new CustomEvent('filtersReset', {
        detail: {
            filterId: filterId
        }
    });
    
    document.dispatchEvent(resetEvent);
    
    console.log('Filtros resetados');
}

// Inicializar filtros quando o documento estiver pronto
document.addEventListener('DOMContentLoaded', function() {
    // Adicionar listeners para eventos de filtros
    document.addEventListener('filtersApplied', function(e) {
        console.log('Evento de filtros aplicados recebido:', e.detail);
        // Aqui você pode adicionar lógica para atualizar a interface
    });
    
    document.addEventListener('filtersReset', function(e) {
        console.log('Evento de filtros resetados recebido:', e.detail);
        // Aqui você pode adicionar lógica para resetar a interface
    });
});

// Exportar funções para uso global
window.toggleFilters = toggleFilters;
window.applyFilters = applyFilters;
window.resetFilters = resetFilters;
</script>