<!-- sidebar_component.html - Componente de sidebar moderno -->
<aside class="sidebar-container-modern {% if classes %}{{ classes }}{% endif %} {% if position == 'right' %}sidebar-right{% else %}sidebar-left{% endif %} {% if collapsed %}sidebar-collapsed{% endif %}" id="{{ sidebar_id }}">
    <div class="sidebar-content">
        <div class="sidebar-header">
            {% if logo or title %}
            <div class="sidebar-brand">
                {% if logo %}
                <img src="{{ logo }}" alt="Logo" class="sidebar-logo">
                {% endif %}
                {% if title %}
                <h1 class="sidebar-title">{{ title }}</h1>
                {% endif %}
            </div>
            {% endif %}
            
            {% if collapsible %}
            <button type="button" class="sidebar-toggle" onclick="toggleSidebar('{{ sidebar_id }}')" aria-label="Alternar sidebar">
                <i class="fas fa-bars"></i>
            </button>
            {% endif %}
        </div>
        
        <div class="sidebar-body">
            {% if search %}
            <div class="sidebar-search">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="{{ search.placeholder|default:'Buscar...' }}" id="{{ sidebar_id }}-search">
                    <button type="button" class="search-clear" id="{{ sidebar_id }}-search-clear" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            {% endif %}
            
            <nav class="sidebar-nav">
                {% for section in sections %}
                <div class="nav-section">
                    {% if section.heading %}
                    <h3 class="nav-section-heading">{{ section.heading }}</h3>
                    {% endif %}
                    
                    <ul class="nav-links">
                        {% for item in section.items %}
                        <li class="nav-item">
                            <a href="{{ item.url }}" class="nav-link {% if item.active %}active{% endif %}" data-nav-item="{{ item.id }}">
                                {% if item.icon %}
                                <i class="{{ item.icon }} nav-icon"></i>
                                {% endif %}
                                <span class="nav-text">{{ item.label }}</span>
                                {% if item.badge %}
                                <span class="nav-badge {% if item.badge.type %}badge-{{ item.badge.type }}{% endif %}">
                                    {{ item.badge.value }}
                                </span>
                                {% endif %}
                            </a>
                            
                            {% if item.submenu %}
                            <ul class="nav-submenu">
                                {% for subitem in item.submenu %}
                                <li class="nav-subitem">
                                    <a href="{{ subitem.url }}" class="nav-sublink {% if subitem.active %}active{% endif %}">
                                        {% if subitem.icon %}
                                        <i class="{{ subitem.icon }} nav-icon"></i>
                                        {% endif %}
                                        <span class="nav-text">{{ subitem.label }}</span>
                                    </a>
                                </li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endfor %}
            </nav>
        </div>
        
        {% if footer %}
        <div class="sidebar-footer">
            {{ footer|safe }}
        </div>
        {% endif %}
    </div>
    
    {% if overlay %}
    <div class="sidebar-overlay" onclick="closeSidebar('{{ sidebar_id }}')"></div>
    {% endif %}
</aside>

<style>
.sidebar-container-modern {
    position: fixed;
    top: 0;
    height: 100vh;
    width: 280px;
    z-index: 1000;
    transition: all 0.3s ease;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    background-color: #ffffff;
    border: 1px solid #e5e7eb;
}

.sidebar-container-modern.sidebar-left {
    left: 0;
}

.sidebar-container-modern.sidebar-right {
    right: 0;
}

.sidebar-container-modern.sidebar-collapsed {
    transform: translateX(-280px);
}

.sidebar-container-modern.sidebar-right.sidebar-collapsed {
    transform: translateX(280px);
}

.sidebar-content {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem;
    border-bottom: 1px solid #e5e7eb;
    background-color: #f9fafb;
}

.sidebar-brand {
    display: flex;
    align-items: center;
}

.sidebar-logo {
    height: 32px;
    width: 32px;
    margin-right: 1rem;
}

.sidebar-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1f2937;
    margin: 0;
}

.sidebar-toggle {
    background: none;
    border: none;
    color: #6b7280;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
    font-size: 1.25rem;
}

.sidebar-toggle:hover {
    background-color: #e5e7eb;
    color: #374151;
}

.sidebar-body {
    flex: 1;
    overflow-y: auto;
    padding: 1rem 0;
}

.sidebar-search {
    padding: 0 1.5rem 1rem 1.5rem;
    border-bottom: 1px solid #e5e7eb;
}

.search-container {
    position: relative;
}

.search-icon {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: #9ca3af;
    font-size: 0.875rem;
}

.search-input {
    width: 100%;
    padding: 0.75rem 2.5rem 0.75rem 2.5rem;
    font-size: 0.875rem;
    line-height: 1.5;
    color: #374151;
    background-color: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
}

.search-input:focus {
    outline: none;
    background-color: #ffffff;
    border-color: #034EA2;
    box-shadow: 0 0 0 3px rgba(3, 78, 162, 0.1);
}

.search-clear {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: #9ca3af;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
    font-size: 0.875rem;
}

.search-clear:hover {
    background-color: #e5e7eb;
    color: #374151;
}

.sidebar-nav {
    padding: 0;
    margin: 0;
}

.nav-section {
    margin-bottom: 1.5rem;
}

.nav-section:first-child {
    margin-top: 0;
}

.nav-section:last-child {
    margin-bottom: 0;
}

.nav-section-heading {
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    color: #9ca3af;
    padding: 0.5rem 1.5rem;
    letter-spacing: 0.05em;
}

.nav-links {
    list-style: none;
    padding: 0;
    margin: 0;
}

.nav-item {
    margin-bottom: 0.125rem;
}

.nav-link {
    display: flex;
    align-items: center;
    padding: 0.75rem 1.5rem;
    color: #4b5563;
    text-decoration: none;
    transition: all 0.2s ease;
    font-size: 0.875rem;
    font-weight: 500;
    position: relative;
}

.nav-link:hover {
    color: #034EA2;
    background-color: #f3f4f6;
}

.nav-link.active {
    color: #034EA2;
    background-color: #eff6ff;
    border-left: 3px solid #034EA2;
}

.nav-link.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
    background-color: #034EA2;
}

.nav-icon {
    width: 1.5rem;
    text-align: center;
    margin-right: 1rem;
    font-size: 1rem;
}

.nav-text {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.nav-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 1.5rem;
    height: 1.5rem;
    padding: 0 0.5rem;
    font-size: 0.75rem;
    font-weight: 600;
    border-radius: 0.75rem;
    color: #ffffff;
}

.nav-badge.badge-primary {
    background-color: #034EA2;
}

.nav-badge.badge-success {
    background-color: #28a745;
}

.nav-badge.badge-warning {
    background-color: #ffc107;
    color: #000000;
}

.nav-badge.badge-danger {
    background-color: #dc3545;
}

.nav-badge.badge-secondary {
    background-color: #6c757d;
}

/* Submenu */
.nav-submenu {
    list-style: none;
    padding: 0;
    margin: 0;
    background-color: #f9fafb;
    border-top: 1px solid #e5e7eb;
    border-bottom: 1px solid #e5e7eb;
}

.nav-subitem .nav-sublink {
    padding: 0.5rem 1.5rem 0.5rem 3.5rem;
    font-size: 0.8125rem;
    color: #6b7280;
    border-left: none;
}

.nav-subitem .nav-sublink:hover {
    background-color: #f3f4f6;
    color: #034EA2;
}

.nav-subitem .nav-sublink.active {
    background-color: #e5e7eb;
    color: #034EA2;
    border-left: none;
}

.sidebar-footer {
    padding: 1rem 1.5rem;
    border-top: 1px solid #e5e7eb;
    background-color: #f9fafb;
}

/* Estados para sidebar colapsada */
.sidebar-container-modern.sidebar-collapsed .sidebar-header {
    justify-content: center;
    padding: 1rem;
}

.sidebar-container-modern.sidebar-collapsed .sidebar-brand {
    flex-direction: column;
}

.sidebar-container-modern.sidebar-collapsed .sidebar-logo {
    margin-right: 0;
    margin-bottom: 0.5rem;
}

.sidebar-container-modern.sidebar-collapsed .sidebar-title {
    font-size: 0.75rem;
    text-align: center;
}

.sidebar-container-modern.sidebar-collapsed .sidebar-toggle {
    position: absolute;
    top: 1rem;
    right: 1rem;
}

.sidebar-container-modern.sidebar-collapsed .nav-section-heading,
.sidebar-container-modern.sidebar-collapsed .nav-text,
.sidebar-container-modern.sidebar-collapsed .nav-badge {
    display: none;
}

.sidebar-container-modern.sidebar-collapsed .sidebar-search {
    padding: 0 1rem 1rem 1rem;
}

.sidebar-container-modern.sidebar-collapsed .search-input {
    padding: 0.75rem 2.5rem 0.75rem 2.5rem;
}

.sidebar-container-modern.sidebar-collapsed .nav-link {
    justify-content: center;
    padding: 1rem 0.5rem;
    flex-direction: column;
}

.sidebar-container-modern.sidebar-collapsed .nav-icon {
    margin-right: 0;
    margin-bottom: 0.25rem;
    font-size: 1.25rem;
}

.sidebar-container-modern.sidebar-collapsed .nav-submenu {
    display: none;
}

/* Overlay para sidebar móvel */
.sidebar-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 999;
    display: none;
}

.sidebar-container-modern.mobile .sidebar-overlay {
    display: block;
}

/* Estados responsivos */
@media (max-width: 768px) {
    .sidebar-container-modern {
        width: 100%;
        max-width: 280px;
        transform: translateX(-100%);
    }
    
    .sidebar-container-modern.sidebar-right {
        transform: translateX(100%);
    }
    
    .sidebar-container-modern.sidebar-open {
        transform: translateX(0);
    }
    
    .sidebar-container-modern.sidebar-right.sidebar-open {
        transform: translateX(0);
    }
    
    .sidebar-header {
        padding: 1rem;
    }
    
    .sidebar-search {
        padding: 0 1rem 1rem 1rem;
    }
    
    .nav-section-heading {
        padding: 0.5rem 1rem;
        font-size: 0.7rem;
    }
    
    .nav-link {
        padding: 0.75rem 1rem;
        font-size: 0.8125rem;
    }
    
    .nav-subitem .nav-sublink {
        padding: 0.5rem 1rem 0.5rem 2.5rem;
        font-size: 0.75rem;
    }
    
    .sidebar-footer {
        padding: 0.75rem 1rem;
    }
}

@media (min-width: 769px) and (max-width: 1024px) {
    .sidebar-container-modern {
        width: 240px;
    }
    
    .nav-link {
        padding: 0.625rem 1.25rem;
        font-size: 0.8125rem;
    }
}

/* Animações */
@keyframes slideInLeft {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(0);
    }
}

@keyframes slideOutLeft {
    from {
        transform: translateX(0);
    }
    to {
        transform: translateX(-100%);
    }
}

/* Estados para diferentes variantes */
.sidebar-container-modern.variant-dark {
    background-color: #1f2937;
    border-color: #374151;
    color: #d1d5db;
}

.sidebar-container-modern.variant-dark .sidebar-header {
    background-color: #111827;
    border-color: #374151;
}

.sidebar-container-modern.variant-dark .sidebar-search {
    border-color: #374151;
}

.sidebar-container-modern.variant-dark .search-input {
    background-color: #111827;
    border-color: #374151;
    color: #ffffff;
}

.sidebar-container-modern.variant-dark .search-input:focus {
    background-color: #111827;
    border-color: #034EA2;
}

.sidebar-container-modern.variant-dark .nav-section-heading {
    color: #9ca3af;
}

.sidebar-container-modern.variant-dark .nav-link {
    color: #d1d5db;
}

.sidebar-container-modern.variant-dark .nav-link:hover {
    color: #034EA2;
    background-color: #111827;
}

.sidebar-container-modern.variant-dark .nav-link.active {
    color: #034EA2;
    background-color: #034EA220;
    border-left: 3px solid #034EA2;
}

.sidebar-container-modern.variant-dark .nav-submenu {
    background-color: #111827;
    border-color: #374151;
}

.sidebar-container-modern.variant-dark .nav-subitem .nav-sublink {
    color: #9ca3af;
}

.sidebar-container-modern.variant-dark .nav-subitem .nav-sublink:hover {
    color: #034EA2;
    background-color: #111827;
}

.sidebar-container-modern.variant-dark .nav-subitem .nav-sublink.active {
    color: #034EA2;
    background-color: #034EA220;
}

.sidebar-container-modern.variant-dark .sidebar-footer {
    background-color: #111827;
    border-color: #374151;
}

/* Estados para sidebar fixa */
.sidebar-container-modern.fixed {
    position: fixed;
    height: 100vh;
}

/* Estados para sidebar flutuante */
.sidebar-container-modern.floating {
    position: absolute;
    height: calc(100% - 1rem);
    margin: 0.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    border: 1px solid #e5e7eb;
}

/* Estados para sidebar com transparência */
.sidebar-container-modern.transparent {
    background-color: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: none;
}

.sidebar-container-modern.transparent .sidebar-header {
    background-color: rgba(249, 250, 251, 0.8);
}

.sidebar-container-modern.transparent .nav-submenu {
    background-color: rgba(249, 250, 251, 0.5);
}
</style>

<script>
class ModernSidebar {
    constructor(sidebarId, options = {}) {
        this.sidebarId = sidebarId;
        this.element = document.getElementById(sidebarId);
        this.toggleButton = this.element ? this.element.querySelector('.sidebar-toggle') : null;
        this.overlay = this.element ? this.element.querySelector('.sidebar-overlay') : null;
        this.searchInput = this.element ? this.element.querySelector('.search-input') : null;
        this.searchClear = this.element ? this.element.querySelector('.search-clear') : null;
        
        this.options = Object.assign({
            position: 'left',
            collapsible: true,
            collapsed: false,
            mobile: false,
            overlay: false,
            onCollapse: null,
            onExpand: null,
            onItemClick: null,
            onSearch: null
        }, options);
        
        this.isCollapsed = this.options.collapsed;
        this.isOpen = !this.options.mobile;
        
        this.init();
    }
    
    init() {
        // Adicionar eventos
        if (this.toggleButton) {
            this.toggleButton.addEventListener('click', () => {
                this.toggle();
            });
        }
        
        if (this.overlay) {
            this.overlay.addEventListener('click', () => {
                this.close();
            });
        }
        
        if (this.searchInput) {
            this.searchInput.addEventListener('input', (e) => {
                this.handleSearch(e.target.value);
            });
        }
        
        if (this.searchClear) {
            this.searchClear.addEventListener('click', () => {
                if (this.searchInput) {
                    this.searchInput.value = '';
                    this.handleSearch('');
                }
            });
        }
        
        // Adicionar eventos de navegação
        const navItems = this.element ? this.element.querySelectorAll('[data-nav-item]') : [];
        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                if (this.options.onItemClick) {
                    e.preventDefault();
                    const itemId = item.getAttribute('data-nav-item');
                    this.options.onItemClick(itemId, item.getAttribute('href'));
                }
                
                // Fechar sidebar em dispositivos móveis
                if (this.options.mobile) {
                    this.close();
                }
            });
        });
        
        // Configurar estado inicial
        if (this.options.collapsed) {
            this.collapse();
        }
    }
    
    toggle() {
        if (this.isCollapsed) {
            this.expand();
        } else {
            this.collapse();
        }
    }
    
    collapse() {
        if (this.isCollapsed) return;
        
        this.element.classList.add('sidebar-collapsed');
        this.isCollapsed = true;
        
        if (this.options.onCollapse) {
            this.options.onCollapse();
        }
        
        // Disparar evento personalizado
        const event = new CustomEvent('sidebarCollapsed', {
            detail: { sidebarId: this.sidebarId }
        });
        document.dispatchEvent(event);
    }
    
    expand() {
        if (!this.isCollapsed) return;
        
        this.element.classList.remove('sidebar-collapsed');
        this.isCollapsed = false;
        
        if (this.options.onExpand) {
            this.options.onExpand();
        }
        
        // Disparar evento personalizado
        const event = new CustomEvent('sidebarExpanded', {
            detail: { sidebarId: this.sidebarId }
        });
        document.dispatchEvent(event);
    }
    
    open() {
        if (this.isOpen) return;
        
        this.element.classList.add('sidebar-open');
        this.isOpen = true;
        
        // Disparar evento personalizado
        const event = new CustomEvent('sidebarOpened', {
            detail: { sidebarId: this.sidebarId }
        });
        document.dispatchEvent(event);
    }
    
    close() {
        if (!this.isOpen) return;
        
        this.element.classList.remove('sidebar-open');
        this.isOpen = false;
        
        // Disparar evento personalizado
        const event = new CustomEvent('sidebarClosed', {
            detail: { sidebarId: this.sidebarId }
        });
        document.dispatchEvent(event);
    }
    
    handleSearch(query) {
        // Mostrar/ocultar botão limpar
        if (this.searchClear) {
            this.searchClear.style.display = query ? 'flex' : 'none';
        }
        
        // Disparar evento de busca
        if (this.options.onSearch) {
            this.options.onSearch(query);
        }
        
        // Disparar evento personalizado
        const event = new CustomEvent('sidebarSearch', {
            detail: { 
                sidebarId: this.sidebarId,
                query: query 
            }
        });
        document.dispatchEvent(event);
    }
    
    setActiveItem(itemId) {
        const navItems = this.element.querySelectorAll('[data-nav-item]');
        navItems.forEach(item => {
            item.classList.remove('active');
            if (item.getAttribute('data-nav-item') === itemId) {
                item.classList.add('active');
                // Expandir submenu se necessário
                const submenu = item.nextElementSibling;
                if (submenu && submenu.classList.contains('nav-submenu')) {
                    submenu.style.display = 'block';
                }
            }
        });
    }
    
    updateBadge(itemId, value, type = 'primary') {
        const item = this.element.querySelector(`[data-nav-item="${itemId}"]`);
        if (item) {
            let badge = item.querySelector('.nav-badge');
            if (!badge) {
                badge = document.createElement('span');
                badge.className = 'nav-badge';
                item.appendChild(badge);
            }
            badge.textContent = value;
            badge.className = `nav-badge badge-${type}`;
        }
    }
}

// Funções utilitárias para criar e gerenciar sidebars
function createSidebar(options) {
    const {
        id = `sidebar-${Date.now()}`,
        position = 'left',
        collapsible = true,
        collapsed = false,
        mobile = false,
        overlay = false,
        logo = null,
        title = null,
        search = null,
        sections = [],
        footer = null,
        variant = null,
        classes = ''
    } = options;
    
    // Criar elemento da sidebar
    const sidebarElement = document.createElement('aside');
    sidebarElement.className = `sidebar-container-modern sidebar-${position} ${classes} ${variant ? `variant-${variant}` : ''}`;
    sidebarElement.id = id;
    sidebarElement.setAttribute('role', 'complementary');
    
    let sidebarContent = '';
    
    sidebarContent += `
        <div class="sidebar-content">
            <div class="sidebar-header">
                ${(logo || title) ? `
                <div class="sidebar-brand">
                    ${logo ? `<img src="${logo}" alt="Logo" class="sidebar-logo">` : ''}
                    ${title ? `<h1 class="sidebar-title">${title}</h1>` : ''}
                </div>
                ` : ''}
                ${collapsible ? `
                <button type="button" class="sidebar-toggle" onclick="toggleSidebar('${id}')" aria-label="Alternar sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                ` : ''}
            </div>
            
            <div class="sidebar-body">
    `;
    
    if (search) {
        sidebarContent += `
                <div class="sidebar-search">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" placeholder="${search.placeholder || 'Buscar...'}" id="${id}-search">
                        <button type="button" class="search-clear" id="${id}-search-clear" style="display: none;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
        `;
    }
    
    sidebarContent += `
                <nav class="sidebar-nav">
    `;
    
    sections.forEach(section => {
        sidebarContent += `
                    <div class="nav-section">
                        ${section.heading ? `<h3 class="nav-section-heading">${section.heading}</h3>` : ''}
                        <ul class="nav-links">
        `;
        
        section.items.forEach(item => {
            sidebarContent += `
                            <li class="nav-item">
                                <a href="${item.url}" class="nav-link ${item.active ? 'active' : ''}" data-nav-item="${item.id}">
                                    ${item.icon ? `<i class="${item.icon} nav-icon"></i>` : ''}
                                    <span class="nav-text">${item.label}</span>
                                    ${item.badge ? `<span class="nav-badge badge-${item.badge.type || 'primary'}">${item.badge.value}</span>` : ''}
                                </a>
            `;
            
            if (item.submenu) {
                sidebarContent += `
                                <ul class="nav-submenu">
                `;
                
                item.submenu.forEach(subitem => {
                    sidebarContent += `
                                    <li class="nav-subitem">
                                        <a href="${subitem.url}" class="nav-sublink ${subitem.active ? 'active' : ''}">
                                            ${subitem.icon ? `<i class="${subitem.icon} nav-icon"></i>` : ''}
                                            <span class="nav-text">${subitem.label}</span>
                                        </a>
                                    </li>
                    `;
                });
                
                sidebarContent += `
                                </ul>
                `;
            }
            
            sidebarContent += `
                            </li>
            `;
        });
        
        sidebarContent += `
                        </ul>
                    </div>
        `;
    });
    
    sidebarContent += `
                </nav>
            </div>
    `;
    
    if (footer) {
        sidebarContent += `
            <div class="sidebar-footer">
                ${footer}
            </div>
        `;
    }
    
    sidebarContent += `
        </div>
    `;
    
    if (overlay) {
        sidebarContent += `
        <div class="sidebar-overlay" onclick="closeSidebar('${id}')"></div>
        `;
    }
    
    sidebarElement.innerHTML = sidebarContent;
    
    // Adicionar ao body
    document.body.appendChild(sidebarElement);
    
    // Criar instância da sidebar
    const sidebarInstance = new ModernSidebar(id, {
        position: position,
        collapsible: collapsible,
        collapsed: collapsed,
        mobile: mobile,
        overlay: overlay
    });
    
    return sidebarInstance;
}

function toggleSidebar(sidebarId) {
    const sidebarElement = document.getElementById(sidebarId);
    if (sidebarElement) {
        const sidebarInstance = window[`sidebar_${sidebarId}`];
        if (sidebarInstance) {
            sidebarInstance.toggle();
        } else {
            // Criar instância se não existir
            window[`sidebar_${sidebarId}`] = new ModernSidebar(sidebarId);
            window[`sidebar_${sidebarId}`].toggle();
        }
    }
}

function openSidebar(sidebarId) {
    const sidebarElement = document.getElementById(sidebarId);
    if (sidebarElement) {
        const sidebarInstance = window[`sidebar_${sidebarId}`];
        if (sidebarInstance) {
            sidebarInstance.open();
        } else {
            // Criar instância se não existir
            window[`sidebar_${sidebarId}`] = new ModernSidebar(sidebarId, { mobile: true });
            window[`sidebar_${sidebarId}`].open();
        }
    }
}

function closeSidebar(sidebarId) {
    const sidebarElement = document.getElementById(sidebarId);
    if (sidebarElement) {
        const sidebarInstance = window[`sidebar_${sidebarId}`];
        if (sidebarInstance) {
            sidebarInstance.close();
        } else {
            // Remover classe diretamente
            sidebarElement.classList.remove('sidebar-open');
        }
    }
}

function setActiveSidebarItem(sidebarId, itemId) {
    const sidebarInstance = window[`sidebar_${sidebarId}`];
    if (sidebarInstance) {
        sidebarInstance.setActiveItem(itemId);
    }
}

function updateSidebarBadge(sidebarId, itemId, value, type = 'primary') {
    const sidebarInstance = window[`sidebar_${sidebarId}`];
    if (sidebarInstance) {
        sidebarInstance.updateBadge(itemId, value, type);
    }
}

// Inicializar sidebars quando o documento estiver pronto
document.addEventListener('DOMContentLoaded', function() {
    // Procurar por elementos com classe sidebar-init
    const sidebarElements = document.querySelectorAll('[data-sidebar-init]');
    
    sidebarElements.forEach(element => {
        const sidebarId = element.id;
        const position = element.getAttribute('data-position') || 'left';
        const collapsible = element.getAttribute('data-collapsible') !== 'false';
        const collapsed = element.getAttribute('data-collapsed') === 'true';
        const mobile = element.getAttribute('data-mobile') === 'true';
        const overlay = element.getAttribute('data-overlay') === 'true';
        
        // Criar instância da sidebar
        window[`sidebar_${sidebarId}`] = new ModernSidebar(sidebarId, {
            position: position,
            collapsible: collapsible,
            collapsed: collapsed,
            mobile: mobile,
            overlay: overlay
        });
    });
});

// Eventos para responder a mudanças no tamanho da janela
window.addEventListener('resize', function() {
    const mobile = window.innerWidth <= 768;
    const sidebarElements = document.querySelectorAll('.sidebar-container-modern');
    
    sidebarElements.forEach(element => {
        const sidebarId = element.id;
        const sidebarInstance = window[`sidebar_${sidebarId}`];
        if (sidebarInstance) {
            // Atualizar estado mobile
            sidebarInstance.options.mobile = mobile;
        }
    });
});

// Exportar funções para uso global
window.ModernSidebar = ModernSidebar;
window.createSidebar = createSidebar;
window.toggleSidebar = toggleSidebar;
window.openSidebar = openSidebar;
window.closeSidebar = closeSidebar;
window.setActiveSidebarItem = setActiveSidebarItem;
window.updateSidebarBadge = updateSidebarBadge;
</script>